<style>
  .popular-products-section {
    padding: {{ section.settings.section_padding_top }}px {{ section.settings.section_padding_horizontal }}px {{ section.settings.section_padding_bottom }}px {{ section.settings.section_padding_horizontal }}px;
    max-width: {{ section.settings.max_width }}px;
    margin: 0 auto;
  }

  .popular-products-header {
    text-align: center;
    margin-bottom: {{ section.settings.header_margin_bottom }}px;
  }

  .popular-products-title {
    font-size: {{ section.settings.heading_font_size }}px;
    font-weight: {{ section.settings.heading_font_weight }};
    color: {{ section.settings.heading_color }};
    margin-bottom: {{ section.settings.heading_margin_bottom }}px;
    line-height: {{ section.settings.heading_line_height }};
  }

  .popular-products-subtitle {
    font-size: {{ section.settings.subheading_font_size }}px;
    color: {{ section.settings.subheading_color }};
    font-weight: {{ section.settings.subheading_font_weight }};
  }

  .popular-products-grid {
    display: flex;
    gap: {{ section.settings.grid_gap }}px;
    max-width: {{ section.settings.max_width }}px;
    margin: 0 auto;
    align-items: stretch;
  }

  .large-image-container {
    flex: 0 0 {{ section.settings.large_image_width }}%;
    display: flex;
  }

  .small-images-grid {
    flex: 1;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(2, 1fr);
    gap: {{ section.settings.small_images_gap }}px;
  }

  .product-image-wrapper {
    position: relative;
    overflow: hidden;
    border-radius: {{ section.settings.image_border_radius }}px;
    width: 100%;
  }

  .small-images-grid .product-image-wrapper {
    aspect-ratio: {{ section.settings.small_image_aspect_ratio }};
    height: 100%;
  }

  .large-image-container .product-image-wrapper {
    width: 100%;
    height: 100%;
    display: flex;
  }

  .product-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .product-image-link {
    display: block;
    width: 100%;
    height: 100%;
  }

  .product-image-wrapper:hover .product-image {
    transform: scale(1.03);
  }

  /* Responsive Design */
  @media screen and (max-width: 768px) {
    .popular-products-title {
      font-size: {{ section.settings.mobile_heading_font_size }}px;
    }

    .popular-products-subtitle {
      font-size: {{ section.settings.mobile_subheading_font_size }}px;
    }

    .popular-products-section {
      padding: {{ section.settings.mobile_section_padding_top }}px {{ section.settings.mobile_section_padding_horizontal }}px {{ section.settings.mobile_section_padding_bottom }}px {{ section.settings.mobile_section_padding_horizontal }}px;
    }

    .popular-products-header {
      margin-bottom: {{ section.settings.mobile_header_margin_bottom }}px;
    }

    .popular-products-grid {
      flex-direction: column;
      gap: {{ section.settings.mobile_grid_gap }}px;
    }

    .large-image-container {
      flex: 0 0 auto;
      width: 100%;
    }

    .large-image-container .product-image-wrapper {
      aspect-ratio: {{ section.settings.mobile_large_image_aspect_ratio }};
      height: {{ section.settings.mobile_large_image_max_height }}px;
      max-height: none;
    }

    .small-images-grid {
      grid-template-columns: repeat({{ section.settings.mobile_grid_columns }}, 1fr);
      grid-template-rows: repeat(auto-fit, {{ section.settings.mobile_small_image_height }}px);
      gap: {{ section.settings.mobile_small_images_gap }}px;
    }

    .small-images-grid .product-image-wrapper {
      aspect-ratio: {{ section.settings.mobile_small_image_aspect_ratio }};
      height: {{ section.settings.mobile_small_image_height }}px;
    }
  }

  @media screen and (max-width: 480px) {
    .popular-products-title {
      font-size: 24px;
    }

    .popular-products-subtitle {
      font-size: 14px;
    }

    .popular-products-section {
      padding: 40px 15px;
    }

    .small-images-grid {
      grid-template-columns: repeat(2, 1fr);
      grid-template-rows: auto;
    }

    .large-image-container .product-image-wrapper {
      height: auto;
      aspect-ratio: 0.85;
    }

    .small-images-grid .product-image-wrapper {
      height: auto;
      aspect-ratio: 1;
    }
  }

  @media screen and (min-width: 769px) and (max-width: 1024px) {
    .small-images-grid {
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(3, 1fr);
    }

    .small-images-grid .product-image-wrapper:nth-child(9) {
      grid-column: 1 / span 3;
    }
  }
</style>

<section class="popular-products-section">
  <div class="popular-products-header">
    <h2 class="popular-products-title">{{ section.settings.heading }}</h2>
    <p class="popular-products-subtitle">{{ section.settings.subheading }}</p>
  </div>

  <div class="popular-products-grid">
    <!-- Large Image -->
    <div class="large-image-container">
      <div class="product-image-wrapper">
        {% if section.settings.large_image_link != blank %}
          <a href="{{ section.settings.large_image_link }}" class="product-image-link">
        {% endif %}

        {% if section.settings.large_image != blank %}
          <img
            src="{{ section.settings.large_image | img_url: '600x750' }}"
            srcset="{{ section.settings.large_image | img_url: '400x500' }} 400w,
                    {{ section.settings.large_image | img_url: '600x750' }} 600w,
                    {{ section.settings.large_image | img_url: '800x1000' }} 800w"
            sizes="(max-width: 768px) 100vw, 50vw"
            alt="{{ section.settings.large_image.alt | default: section.settings.heading }}"
            class="product-image"
            loading="lazy"
          >
        {% else %}
          {{ 'product-1' | placeholder_svg_tag: 'product-image' }}
        {% endif %}

        {% if section.settings.large_image_link != blank %}
          </a>
        {% endif %}
      </div>
    </div>

    <!-- Small Images Grid -->
    <div class="small-images-grid">
      {% for i in (1..8) %}
        {% assign image_setting = 'small_image_' | append: i %}
        {% assign link_setting = 'small_image_link_' | append: i %}

        <div class="product-image-wrapper">
          {% if section.settings[link_setting] != blank %}
            <a href="{{ section.settings[link_setting] }}" class="product-image-link">
          {% endif %}

          {% if section.settings[image_setting] != blank %}
            <img
              src="{{ section.settings[image_setting] | img_url: '300x300' }}"
              srcset="{{ section.settings[image_setting] | img_url: '200x200' }} 200w,
                      {{ section.settings[image_setting] | img_url: '300x300' }} 300w,
                      {{ section.settings[image_setting] | img_url: '400x400' }} 400w"
              sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 25vw"
              alt="{{ section.settings[image_setting].alt | default: section.settings.heading }}"
              class="product-image"
              loading="lazy"
            >
          {% else %}
            {{ 'product-' | append: i | append: '' | placeholder_svg_tag: 'product-image' }}
          {% endif %}

          {% if section.settings[link_setting] != blank %}
            </a>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Popular Products Grid",
  "settings": [
    {
      "type": "header",
      "content": "Section Layout"
    },
    {
      "type": "range",
      "id": "max_width",
      "min": 900,
      "max": 1600,
      "step": 50,
      "unit": "px",
      "label": "Maximum width",
      "default": 1200
    },
    {
      "type": "range",
      "id": "section_padding_top",
      "min": 0,
      "max": 120,
      "step": 5,
      "unit": "px",
      "label": "Section padding top",
      "default": 60
    },
    {
      "type": "range",
      "id": "section_padding_bottom",
      "min": 0,
      "max": 120,
      "step": 5,
      "unit": "px",
      "label": "Section padding bottom",
      "default": 60
    },
    {
      "type": "range",
      "id": "section_padding_horizontal",
      "min": 0,
      "max": 60,
      "step": 5,
      "unit": "px",
      "label": "Section horizontal padding",
      "default": 20
    },
    {
      "type": "header",
      "content": "Text Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Discover our most popular products"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Made with love by frens ❤️"
    },
    {
      "type": "header",
      "content": "Typography - Heading"
    },
    {
      "type": "range",
      "id": "heading_font_size",
      "min": 24,
      "max": 72,
      "step": 2,
      "unit": "px",
      "label": "Heading font size",
      "default": 48
    },
    {
      "type": "select",
      "id": "heading_font_weight",
      "label": "Heading font weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi Bold"
        },
        {
          "value": "700",
          "label": "Bold"
        },
        {
          "value": "800",
          "label": "Extra Bold"
        }
      ],
      "default": "700"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "heading_line_height",
      "min": 0.8,
      "max": 2,
      "step": 0.1,
      "label": "Heading line height",
      "default": 1.2
    },
    {
      "type": "range",
      "id": "heading_margin_bottom",
      "min": 0,
      "max": 30,
      "step": 2,
      "unit": "px",
      "label": "Space below heading",
      "default": 8
    },
    {
      "type": "header",
      "content": "Typography - Subheading"
    },
    {
      "type": "range",
      "id": "subheading_font_size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Subheading font size",
      "default": 16
    },
    {
      "type": "select",
      "id": "subheading_font_weight",
      "label": "Subheading font weight",
      "options": [
        {
          "value": "300",
          "label": "Light"
        },
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi Bold"
        }
      ],
      "default": "400"
    },
    {
      "type": "color",
      "id": "subheading_color",
      "label": "Subheading color",
      "default": "#666666"
    },
    {
      "type": "range",
      "id": "header_margin_bottom",
      "min": 10,
      "max": 80,
      "step": 5,
      "unit": "px",
      "label": "Space below header section",
      "default": 30
    },
    {
      "type": "header",
      "content": "Image Layout"
    },
    {
      "type": "range",
      "id": "large_image_width",
      "min": 30,
      "max": 50,
      "step": 1,
      "unit": "%",
      "label": "Large image width",
      "default": 40,
      "info": "Percentage of total width"
    },
    {
      "type": "range",
      "id": "small_image_aspect_ratio",
      "min": 1,
      "max": 2.5,
      "step": 0.1,
      "label": "Small images aspect ratio",
      "default": 1.7,
      "info": "Higher value = wider/shorter images"
    },
    {
      "type": "range",
      "id": "grid_gap",
      "min": 8,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Gap between large and small images",
      "default": 16
    },
    {
      "type": "range",
      "id": "small_images_gap",
      "min": 8,
      "max": 24,
      "step": 2,
      "unit": "px",
      "label": "Gap between small images",
      "default": 12
    },
    {
      "type": "range",
      "id": "image_border_radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Image border radius",
      "default": 8
    },
    {
      "type": "header",
      "content": "Large Image"
    },
    {
      "type": "image_picker",
      "id": "large_image",
      "label": "Large Image (Left)"
    },
    {
      "type": "url",
      "id": "large_image_link",
      "label": "Large Image Link"
    },
    {
      "type": "header",
      "content": "Small Images Grid"
    },
    {
      "type": "image_picker",
      "id": "small_image_1",
      "label": "Small Image 1"
    },
    {
      "type": "url",
      "id": "small_image_link_1",
      "label": "Small Image 1 Link"
    },
    {
      "type": "image_picker",
      "id": "small_image_2",
      "label": "Small Image 2"
    },
    {
      "type": "url",
      "id": "small_image_link_2",
      "label": "Small Image 2 Link"
    },
    {
      "type": "image_picker",
      "id": "small_image_3",
      "label": "Small Image 3"
    },
    {
      "type": "url",
      "id": "small_image_link_3",
      "label": "Small Image 3 Link"
    },
    {
      "type": "image_picker",
      "id": "small_image_4",
      "label": "Small Image 4"
    },
    {
      "type": "url",
      "id": "small_image_link_4",
      "label": "Small Image 4 Link"
    },
    {
      "type": "image_picker",
      "id": "small_image_5",
      "label": "Small Image 5"
    },
    {
      "type": "url",
      "id": "small_image_link_5",
      "label": "Small Image 5 Link"
    },
    {
      "type": "image_picker",
      "id": "small_image_6",
      "label": "Small Image 6"
    },
    {
      "type": "url",
      "id": "small_image_link_6",
      "label": "Small Image 6 Link"
    },
    {
      "type": "image_picker",
      "id": "small_image_7",
      "label": "Small Image 7"
    },
    {
      "type": "url",
      "id": "small_image_link_7",
      "label": "Small Image 7 Link"
    },
    {
      "type": "image_picker",
      "id": "small_image_8",
      "label": "Small Image 8"
    },
    {
      "type": "url",
      "id": "small_image_link_8",
      "label": "Small Image 8 Link"
    },
    {
      "type": "header",
      "content": "Mobile Layout Settings"
    },
    {
      "type": "range",
      "id": "mobile_section_padding_top",
      "min": 0,
      "max": 80,
      "step": 5,
      "unit": "px",
      "label": "Mobile section padding top",
      "default": 40
    },
    {
      "type": "range",
      "id": "mobile_section_padding_bottom",
      "min": 0,
      "max": 80,
      "step": 5,
      "unit": "px",
      "label": "Mobile section padding bottom",
      "default": 40
    },
    {
      "type": "range",
      "id": "mobile_section_padding_horizontal",
      "min": 0,
      "max": 40,
      "step": 5,
      "unit": "px",
      "label": "Mobile horizontal padding",
      "default": 15
    },
    {
      "type": "range",
      "id": "mobile_heading_font_size",
      "min": 20,
      "max": 48,
      "step": 2,
      "unit": "px",
      "label": "Mobile heading font size",
      "default": 32
    },
    {
      "type": "range",
      "id": "mobile_subheading_font_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Mobile subheading font size",
      "default": 14
    },
    {
      "type": "range",
      "id": "mobile_header_margin_bottom",
      "min": 10,
      "max": 50,
      "step": 5,
      "unit": "px",
      "label": "Mobile space below header",
      "default": 20
    },
    {
      "type": "range",
      "id": "mobile_grid_gap",
      "min": 8,
      "max": 24,
      "step": 2,
      "unit": "px",
      "label": "Mobile gap between sections",
      "default": 12
    },
    {
      "type": "range",
      "id": "mobile_grid_columns",
      "min": 1,
      "max": 3,
      "step": 1,
      "label": "Mobile grid columns",
      "default": 2,
      "info": "Number of columns for small images on mobile"
    },
    {
      "type": "range",
      "id": "mobile_large_image_aspect_ratio",
      "min": 0.8,
      "max": 2.0,
      "step": 0.1,
      "label": "Mobile large image aspect ratio",
      "default": 1.3,
      "info": "Higher value = wider/shorter image"
    },
    {
      "type": "range",
      "id": "mobile_large_image_max_height",
      "min": 150,
      "max": 500,
      "step": 10,
      "unit": "px",
      "label": "Mobile large image height",
      "default": 250
    },
    {
      "type": "range",
      "id": "mobile_small_image_aspect_ratio",
      "min": 0.8,
      "max": 2.0,
      "step": 0.1,
      "label": "Mobile small images aspect ratio",
      "default": 1.2,
      "info": "Higher value = wider/shorter images"
    },
    {
      "type": "range",
      "id": "mobile_small_image_height",
      "min": 80,
      "max": 250,
      "step": 10,
      "unit": "px",
      "label": "Mobile small images height",
      "default": 120
    },
    {
      "type": "range",
      "id": "mobile_small_images_gap",
      "min": 8,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Mobile gap between small images",
      "default": 10
    }
  ],
  "presets": [
    {
      "name": "Popular Products Grid",
      "category": "Image"
    }
  ]
}
{% endschema %}