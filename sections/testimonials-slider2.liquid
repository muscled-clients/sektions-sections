{% style %}
  #testimonials-slider2-{{ section.id }} {
    width: 100%;
    max-width: 100vw;
    margin-top: {{ section.settings.top_margin }}px;
    margin-bottom: {{ section.settings.bottom_margin }}px;
    padding: {{ section.settings.inside_section_spacing }}px 0;
    overflow: hidden;
    {% if section.settings.style == 'standard' %}
    background-image: linear-gradient(to top, #EFEFEF, #FFFFFF);
    {% elsif section.settings.style == 'trustpilot' %}
    background-image: linear-gradient(to top, #DEF6ED, #FFFFFF);
    {% elsif section.settings.style == 'google' %}
    background-image: linear-gradient(to top, #FFF8DE, #FFFFFF);
    {% elsif section.settings.style == 'custom' %}
    background: linear-gradient(180deg, {{ section.settings.gradient_start_color }} 0%, {{ section.settings.background_color }} 100%);
    {% else %}
    background-color: {{ section.settings.background_color }};
    {% endif %}
    position: relative;
    z-index: 1;
    font-family: {{ section.settings.subtitle_font }};
  }

  #testimonials-slider2-{{ section.id }} .container {
    max-width: 100%;
    width: 100%;
    margin: 0 auto;
    overflow: hidden;
  }

  #testimonials-slider2-{{ section.id }} .header-section {
    text-align: center;
    margin-bottom: 30px;
  }

  #testimonials-slider2-{{ section.id }} .main-title {
    font-size: 36px;
    font-weight: 700;
    color: {{ section.settings.title_color }};
    margin: 0 0 10px 0;
    font-family: {{ section.settings.header_font }};
  }

  #testimonials-slider2-{{ section.id }} .sub-title {
    font-size: 18px;
    font-weight: 400;
    color: {{ section.settings.subtitle_color }};
    margin: 0 0 15px 0;
    font-family: {{ section.settings.subtitle_font }};
  }

  #testimonials-slider2-{{ section.id }} .rating-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  #testimonials-slider2-{{ section.id }} .rating-text {
    font-size: 14px;
    color: {{ section.settings.subtitle_color }};
    font-family: {{ section.settings.rating_font }};
  }

  #testimonials-slider2-{{ section.id }} .rating-stars {
    display: flex;
    gap: 2px;
  }

  #testimonials-slider2-{{ section.id }} .rating-stars.standard svg {
    fill: {{ section.settings.stars_header }};
    width: 18px;
    height: 18px;
  }

  #testimonials-slider2-{{ section.id }} .rating-stars.trustpilot {
    background-color: #00B67A;
    padding: 4px 8px;
    border-radius: 4px;
    display: flex;
    gap: 3px;
  }

  #testimonials-slider2-{{ section.id }} .rating-stars.trustpilot svg {
    fill: #fff;
    width: 16px;
    height: 16px;
  }

  #testimonials-slider2-{{ section.id }} .rating-stars.google svg {
    fill: {{ section.settings.stars_header }};
    width: 18px;
    height: 18px;
  }

  #testimonials-slider2-{{ section.id }} .own-logo {
    max-height: 30px;
    object-fit: contain;
  }

  #testimonials-slider2-{{ section.id }} .slider-wrapper {
    position: relative;
    padding: 20px 60px;
  }

  #testimonials-slider2-{{ section.id }} .slider-container {
    overflow: visible;
  }

  #testimonials-slider2-{{ section.id }} .slider-track {
    position: relative;
    height: 300px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #testimonials-slider2-{{ section.id }} .testimonial-card {
    position: absolute;
    width: 350px;
    background-color: {{ section.settings.box_background }};
    border-radius: 12px;
    padding: 24px 28px;
    box-sizing: border-box;
    transition: all 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
    border: 1px solid rgba(0, 0, 0, 0.08);
  }

  /* Position 0 - far left (edge visible) */
  #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="0"] {
    left: calc(50% - 175px - 780px);
    opacity: 0.4;
    z-index: 1;
  }

  /* Position 1 - adjacent left */
  #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="1"] {
    left: calc(50% - 175px - 390px);
    opacity: 0.7;
    z-index: 2;
  }

  /* Position 2 - center (active) */
  #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="2"] {
    left: calc(50% - 175px);
    opacity: 1;
    z-index: 3;
    transform: scale(1.12);
  }

  /* Position 3 - adjacent right */
  #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="3"] {
    left: calc(50% - 175px + 390px);
    opacity: 0.7;
    z-index: 2;
  }

  /* Position 4 - far right (edge visible) */
  #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="4"] {
    left: calc(50% - 175px + 780px);
    opacity: 0.4;
    z-index: 1;
  }

  /* Hidden positions for smooth entry/exit */
  #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="-1"] {
    left: calc(50% - 175px - 1170px);
    opacity: 0;
    z-index: 0;
  }

  #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="5"] {
    left: calc(50% - 175px + 1170px);
    opacity: 0;
    z-index: 0;
  }

  #testimonials-slider2-{{ section.id }} .testimonial-text {
    font-size: 15px;
    line-height: 1.6;
    color: {{ section.settings.review_text_color }};
    margin: 0 0 10px 0;
    font-weight: 400;
    font-family: {{ section.settings.subtitle_font }};
  }

  #testimonials-slider2-{{ section.id }} .verified-row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 10px;
  }

  #testimonials-slider2-{{ section.id }} .verified-icon {
    width: 20px;
    height: 20px;
    fill: none;
    stroke: #999999;
    stroke-width: 1.5;
  }

  #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="2"] .verified-icon {
    stroke: #333333;
  }

  #testimonials-slider2-{{ section.id }} .verified-text {
    font-size: 14px;
    color: #999999;
    font-family: 'Poppins', sans-serif;
    font-weight: 400;
  }

  #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="2"] .verified-text {
    color: #333333;
  }

  #testimonials-slider2-{{ section.id }} .reviewer-info {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  #testimonials-slider2-{{ section.id }} .reviewer-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    background-color: #e0e0e0;
  }

  #testimonials-slider2-{{ section.id }} .reviewer-avatar-placeholder {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: #e0e0e0;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #testimonials-slider2-{{ section.id }} .reviewer-avatar-placeholder svg {
    width: 26px;
    height: 26px;
    fill: #999;
  }

  #testimonials-slider2-{{ section.id }} .reviewer-details {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  #testimonials-slider2-{{ section.id }} .reviewer-name {
    font-size: 14px;
    font-weight: 600;
    color: {{ section.settings.box_text }};
    font-family: 'Poppins', sans-serif;
  }

  #testimonials-slider2-{{ section.id }} .reviewer-date {
    font-size: 12px;
    color: #888888;
    font-family: 'Poppins', sans-serif;
  }

  #testimonials-slider2-{{ section.id }} .card-stars {
    display: flex;
    gap: 3px;
    margin-left: auto;
  }

  #testimonials-slider2-{{ section.id }} .card-stars svg {
    fill: {{ section.settings.stars_box }};
    width: 18px;
    height: 18px;
  }

  #testimonials-slider2-{{ section.id }} .nav-arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 50px;
    height: 50px;
    background: #fff;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    transition: all 0.2s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  #testimonials-slider2-{{ section.id }} .nav-arrow:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  #testimonials-slider2-{{ section.id }} .nav-arrow.prev {
    left: 20px;
  }

  #testimonials-slider2-{{ section.id }} .nav-arrow.next {
    right: 20px;
  }

  #testimonials-slider2-{{ section.id }} .nav-arrow svg {
    width: 32px;
    height: 32px;
    fill: #333;
  }

  #testimonials-slider2-{{ section.id }} .bottom-button {
    text-align: center;
    margin-top: 30px;
  }

  #testimonials-slider2-{{ section.id }} .cta-button {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 12px 24px;
    background-color: {{ section.settings.button_background }};
    color: {{ section.settings.button_text_color }};
    text-decoration: none;
    border-radius: 25px;
    font-size: 14px;
    font-weight: 500;
    transition: opacity 0.2s ease;
  }

  #testimonials-slider2-{{ section.id }} .cta-button:hover {
    opacity: 0.9;
  }

  #testimonials-slider2-{{ section.id }} .cta-button .btn-logo {
    height: 18px;
    object-fit: contain;
  }

  #testimonials-slider2-{{ section.id }} .cta-button .trustpilot-logo svg {
    height: 18px;
    width: auto;
  }

  #testimonials-slider2-{{ section.id }} .cta-button .google-logo svg {
    height: 18px;
    width: auto;
  }

  /* Laptop 1024px */
  @media (max-width: 1024px) {
    #testimonials-slider2-{{ section.id }} .testimonial-card {
      width: 320px;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="0"] {
      left: calc(50% - 160px - 700px);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="1"] {
      left: calc(50% - 160px - 350px);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="2"] {
      left: calc(50% - 160px);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="3"] {
      left: calc(50% - 160px + 350px);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="4"] {
      left: calc(50% - 160px + 700px);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="-1"] {
      left: calc(50% - 160px - 1050px);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="5"] {
      left: calc(50% - 160px + 1050px);
    }
  }

  /* Tablet responsive */
  @media (max-width: 768px) {
    #testimonials-slider2-{{ section.id }} .main-title {
      font-size: 32px;
    }

    #testimonials-slider2-{{ section.id }} .sub-title {
      font-size: 16px;
    }

    #testimonials-slider2-{{ section.id }} .slider-wrapper {
      padding: 20px 0;
    }

    #testimonials-slider2-{{ section.id }} .slider-track {
      height: 320px;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card {
      width: 280px;
      padding: 22px;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="0"] {
      left: calc(50% - 140px - 600px);
      opacity: 0.3;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="1"] {
      left: calc(50% - 140px - 300px);
      opacity: 0.5;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="2"] {
      left: calc(50% - 140px);
      transform: scale(1.08);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="3"] {
      left: calc(50% - 140px + 300px);
      opacity: 0.5;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="4"] {
      left: calc(50% - 140px + 600px);
      opacity: 0.3;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="-1"] {
      left: calc(50% - 140px - 900px);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="5"] {
      left: calc(50% - 140px + 900px);
    }

    #testimonials-slider2-{{ section.id }} .nav-arrow {
      width: 40px;
      height: 40px;
    }

    #testimonials-slider2-{{ section.id }} .nav-arrow svg {
      width: 24px;
      height: 24px;
    }

    #testimonials-slider2-{{ section.id }} .nav-arrow.prev {
      left: 10px;
    }

    #testimonials-slider2-{{ section.id }} .nav-arrow.next {
      right: 10px;
    }
  }

  /* Mobile L (425px) */
  @media (max-width: 480px) {
    #testimonials-slider2-{{ section.id }} .main-title {
      font-size: 26px;
    }

    #testimonials-slider2-{{ section.id }} .sub-title {
      font-size: 14px;
    }

    #testimonials-slider2-{{ section.id }} .rating-text {
      font-size: 12px;
    }

    #testimonials-slider2-{{ section.id }} .slider-track {
      height: 300px;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card {
      width: 260px;
      padding: 20px;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="0"] {
      left: calc(50% - 130px - 540px);
      opacity: 0.2;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="1"] {
      left: calc(50% - 130px - 275px);
      opacity: 0.4;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="2"] {
      left: calc(50% - 130px);
      transform: scale(1.05);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="3"] {
      left: calc(50% - 130px + 275px);
      opacity: 0.4;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="4"] {
      left: calc(50% - 130px + 540px);
      opacity: 0.2;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="-1"] {
      left: calc(50% - 130px - 810px);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="5"] {
      left: calc(50% - 130px + 810px);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-text {
      font-size: 14px;
    }

    #testimonials-slider2-{{ section.id }} .nav-arrow {
      width: 36px;
      height: 36px;
    }

    #testimonials-slider2-{{ section.id }} .nav-arrow svg {
      width: 20px;
      height: 20px;
    }

    #testimonials-slider2-{{ section.id }} .nav-arrow.prev {
      left: 5px;
    }

    #testimonials-slider2-{{ section.id }} .nav-arrow.next {
      right: 5px;
    }
  }

  /* Mobile M (375px) */
  @media (max-width: 400px) {
    #testimonials-slider2-{{ section.id }} .main-title {
      font-size: 24px;
    }

    #testimonials-slider2-{{ section.id }} .slider-track {
      height: 290px;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card {
      width: 240px;
      padding: 18px;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="1"] {
      left: calc(50% - 120px - 255px);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="2"] {
      left: calc(50% - 120px);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="3"] {
      left: calc(50% - 120px + 255px);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-text {
      font-size: 13px;
      line-height: 1.5;
    }

    #testimonials-slider2-{{ section.id }} .reviewer-name {
      font-size: 13px;
    }

    #testimonials-slider2-{{ section.id }} .reviewer-date {
      font-size: 11px;
    }

    #testimonials-slider2-{{ section.id }} .verified-text {
      font-size: 12px;
    }

    #testimonials-slider2-{{ section.id }} .verified-icon {
      width: 16px;
      height: 16px;
    }

    #testimonials-slider2-{{ section.id }} .card-stars svg {
      width: 14px;
      height: 14px;
    }

    #testimonials-slider2-{{ section.id }} .reviewer-avatar,
    #testimonials-slider2-{{ section.id }} .reviewer-avatar-placeholder {
      width: 35px;
      height: 35px;
    }
  }

  /* Mobile S (320px) */
  @media (max-width: 350px) {
    #testimonials-slider2-{{ section.id }} .main-title {
      font-size: 22px;
    }

    #testimonials-slider2-{{ section.id }} .sub-title {
      font-size: 13px;
    }

    #testimonials-slider2-{{ section.id }} .slider-track {
      height: 320px;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card {
      width: 280px;
      padding: 24px;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="0"],
    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="4"] {
      opacity: 0;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="1"] {
      left: calc(50% - 140px - 300px);
      opacity: 0;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="2"] {
      left: calc(50% - 140px);
      transform: scale(1);
    }

    #testimonials-slider2-{{ section.id }} .testimonial-card[data-position="3"] {
      left: calc(50% - 140px + 300px);
      opacity: 0;
    }

    #testimonials-slider2-{{ section.id }} .testimonial-text {
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 16px;
    }

    #testimonials-slider2-{{ section.id }} .verified-row {
      margin-bottom: 16px;
    }

    #testimonials-slider2-{{ section.id }} .verified-text {
      font-size: 14px;
    }

    #testimonials-slider2-{{ section.id }} .verified-icon {
      width: 18px;
      height: 18px;
    }

    #testimonials-slider2-{{ section.id }} .reviewer-name {
      font-size: 14px;
    }

    #testimonials-slider2-{{ section.id }} .reviewer-date {
      font-size: 12px;
    }

    #testimonials-slider2-{{ section.id }} .reviewer-avatar,
    #testimonials-slider2-{{ section.id }} .reviewer-avatar-placeholder {
      width: 40px;
      height: 40px;
    }

    #testimonials-slider2-{{ section.id }} .card-stars svg {
      width: 16px;
      height: 16px;
    }

    #testimonials-slider2-{{ section.id }} .nav-arrow {
      width: 32px;
      height: 32px;
    }

    #testimonials-slider2-{{ section.id }} .nav-arrow svg {
      width: 18px;
      height: 18px;
    }
  }
{% endstyle %}

<div id="testimonials-slider2-{{ section.id }}">
  <div class="container">
    <div class="header-section">
      {% if section.settings.header != blank %}
        <h2 class="main-title">{{ section.settings.header }}</h2>
      {% endif %}
      {% if section.settings.sub_header != blank %}
        <p class="sub-title">{{ section.settings.sub_header }}</p>
      {% endif %}

      <div class="rating-row">
        {% if section.settings.rating_text != blank %}
          <span class="rating-text">{{ section.settings.rating_text }}</span>
        {% endif %}

        {% if section.settings.style == 'standard' %}
          <div class="rating-stars standard">
            {% for i in (1..section.settings.number_of_ratings) %}
              <svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
            {% endfor %}
          </div>
        {% elsif section.settings.style == 'trustpilot' %}
          <div class="rating-stars trustpilot">
            {% for i in (1..section.settings.number_of_ratings) %}
              <svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
            {% endfor %}
          </div>
        {% elsif section.settings.style == 'google' %}
          <div class="rating-stars google">
            {% for i in (1..section.settings.number_of_ratings) %}
              <svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
            {% endfor %}
          </div>
        {% elsif section.settings.style == 'custom' and section.settings.own_logo != blank %}
          <img class="own-logo" src="{{ section.settings.own_logo | image_url: width: 200 }}" alt="Rating logo">
        {% endif %}
      </div>
    </div>

    <div class="slider-wrapper">
      <div class="slider-container">
        <div class="slider-track" id="slider-track-{{ section.id }}">
          {% comment %} Cards will be rendered by JavaScript for infinite loop {% endcomment %}
        </div>
      </div>

      <!-- Hidden card templates -->
      <div class="card-templates" id="card-templates-{{ section.id }}" style="display:none;">
        {% for block in section.blocks %}
          <div class="card-template" data-card-index="{{ forloop.index0 }}" {{ block.shopify_attributes }}>
            {% if block.settings.review_text != blank %}
              <p class="testimonial-text">{{ block.settings.review_text }}</p>
            {% endif %}

            <div class="verified-row">
              <svg class="verified-icon" viewBox="0 0 50 50"><path d="M25 4 C27.5 4 29 6 30 8 C32 7 35 7 37 9 C39 11 39 14 38 16 C40 17 42 19.5 42 22 C42 24.5 40 27 38 28 C39 30 39 33 37 35 C35 37 32 37 30 36 C29 38 27.5 40 25 40 C22.5 40 21 38 20 36 C18 37 15 37 13 35 C11 33 11 30 12 28 C10 27 8 24.5 8 22 C8 19.5 10 17 12 16 C11 14 11 11 13 9 C15 7 18 7 20 8 C21 6 22.5 4 25 4 Z" fill="none"/><path d="M18 22l5 5 9-9" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
              <span class="verified-text">{{ section.settings.verified_text }}</span>
            </div>

            <div class="reviewer-info">
              {% if section.settings.show_avatar and block.settings.avatar != blank %}
                <img class="reviewer-avatar" src="{{ block.settings.avatar | image_url: width: 80 }}" alt="{{ block.settings.name }}">
              {% elsif section.settings.show_avatar %}
                <div class="reviewer-avatar-placeholder">
                  <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                </div>
              {% endif %}

              <div class="reviewer-details">
                {% if block.settings.name != blank %}
                  <span class="reviewer-name">{{ block.settings.name }}</span>
                {% endif %}
                {% if block.settings.date != blank %}
                  <span class="reviewer-date">{{ block.settings.date }}</span>
                {% endif %}
              </div>

              <div class="card-stars">
                {% for i in (1..block.settings.stars) %}
                  <svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                {% endfor %}
              </div>
            </div>
          </div>
        {% endfor %}
      </div>

      <button class="nav-arrow prev" id="prev-{{ section.id }}" aria-label="Previous">
        <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
      </button>
      <button class="nav-arrow next" id="next-{{ section.id }}" aria-label="Next">
        <svg viewBox="0 0 24 24"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>
      </button>
    </div>

    {% if section.settings.show_button %}
      <div class="bottom-button">
        <a href="{{ section.settings.button_link }}" class="cta-button">
          <span>{{ section.settings.button_text }}</span>
          {% if section.settings.style == 'trustpilot' %}
            <span class="trustpilot-logo">
              <svg viewBox="0 0 126 31" fill="#fff"><path d="M33.3 11.9h-4.2l-1.3-4.1-1.3 4.1h-4.2l3.4 2.5-1.3 4 3.4-2.5 3.4 2.5-1.3-4 3.4-2.5zM40.8 0h3.5l1.1 8.5 4.4-8.5h3.6l-6.6 12v7.2h-3.3V12L40.8 0zm16.9 9.4c-.8 0-1.5.3-2 .8-.5.5-.9 1.3-1 2.4h5.8c-.1-1-.4-1.8-.9-2.3-.6-.6-1.2-.9-1.9-.9zm6.2 5.7h-9.2c.1 1.1.5 2 1.1 2.5.6.6 1.4.9 2.3.9 1.3 0 2.4-.6 3.1-1.7l2.6 1.2c-.6 1-1.4 1.8-2.4 2.4-1 .5-2.1.8-3.4.8-1.9 0-3.5-.6-4.7-1.9-1.2-1.3-1.8-2.9-1.8-4.9 0-2 .6-3.7 1.8-4.9 1.2-1.3 2.7-1.9 4.5-1.9 1.9 0 3.4.6 4.5 1.9 1.1 1.2 1.6 2.9 1.6 4.9v.7zm3.8 4.1V7.6h3.2v1.9c.5-.8 1-1.3 1.6-1.7.6-.3 1.3-.5 2.2-.5.6 0 1.2.1 1.6.3l-.5 3c-.4-.2-.9-.3-1.4-.3-.9 0-1.6.3-2.1 1-.5.6-.8 1.6-.8 2.8v5.1h-3.2v.1h-.6zm12 0V7.6h3.2v11.6h-3.2zm1.6-13.3c-.6 0-1-.2-1.4-.5-.4-.4-.5-.8-.5-1.3s.2-1 .5-1.3c.4-.4.8-.5 1.4-.5s1 .2 1.4.5c.4.4.5.8.5 1.3s-.2 1-.5 1.3c-.4.4-.8.5-1.4.5zm7.5 13.3V10.1h-2v-2.5h2V4.2h3.2v3.4h2.7v2.5h-2.7v5.3c0 .7.1 1.1.4 1.4.2.3.6.4 1.2.4.4 0 .8 0 1.2-.1v2.7c-.7.2-1.4.3-2.2.3-1.5 0-2.5-.4-3.1-1.1-.5-.6-.7-1.5-.7-2.8h-.1.1zm12.6-9.8c-.8 0-1.5.3-2 .8-.5.5-.9 1.3-1 2.4h5.8c-.1-1-.4-1.8-.9-2.3-.5-.6-1.1-.9-1.9-.9zm6.3 5.7h-9.2c.1 1.1.5 2 1.1 2.5.6.6 1.4.9 2.3.9 1.3 0 2.4-.6 3.1-1.7l2.6 1.2c-.6 1-1.4 1.8-2.4 2.4-1 .5-2.1.8-3.4.8-1.9 0-3.5-.6-4.7-1.9-1.2-1.3-1.8-2.9-1.8-4.9 0-2 .6-3.7 1.8-4.9 1.2-1.3 2.7-1.9 4.5-1.9 1.9 0 3.4.6 4.5 1.9 1.1 1.2 1.6 2.9 1.6 4.9v.7zm3.9 4.1V7.6h3.2v1.9c.5-.8 1-1.3 1.6-1.7.6-.3 1.3-.5 2.2-.5.6 0 1.2.1 1.6.3l-.5 3c-.4-.2-.9-.3-1.4-.3-.9 0-1.6.3-2.1 1-.5.6-.8 1.6-.8 2.8v5.1h-3.2v.1h-.6z"/></svg>
            </span>
          {% elsif section.settings.style == 'google' %}
            <span class="google-logo">
              <svg viewBox="0 0 74 24" height="18"><path fill="#4285F4" d="M9.24 8.19v2.46h5.88c-.18 1.38-.64 2.39-1.34 3.1-.86.86-2.2 1.8-4.54 1.8-3.62 0-6.45-2.92-6.45-6.54s2.83-6.54 6.45-6.54c1.95 0 3.38.77 4.43 1.76L15.4 2.5C13.94 1.08 11.98 0 9.24 0 4.28 0 .11 4.04.11 9s4.17 9 9.13 9c2.68 0 4.7-.88 6.28-2.52 1.62-1.62 2.13-3.91 2.13-5.75 0-.57-.04-1.1-.13-1.54H9.24z"/><path fill="#EA4335" d="M25 6.19c-3.21 0-5.83 2.44-5.83 5.81 0 3.34 2.62 5.81 5.83 5.81s5.83-2.46 5.83-5.81c0-3.37-2.62-5.81-5.83-5.81zm0 9.33c-1.76 0-3.28-1.45-3.28-3.52 0-2.09 1.52-3.52 3.28-3.52s3.28 1.43 3.28 3.52c0 2.07-1.52 3.52-3.28 3.52z"/><path fill="#FBBC05" d="M53.58 7.49h-.09c-.57-.68-1.67-1.3-3.06-1.3C47.53 6.19 45 8.72 45 12c0 3.26 2.53 5.81 5.43 5.81 1.39 0 2.49-.62 3.06-1.32h.09v.81c0 2.22-1.19 3.41-3.1 3.41-1.56 0-2.53-1.12-2.93-2.07l-2.22.92c.64 1.54 2.33 3.43 5.15 3.43 2.99 0 5.52-1.76 5.52-6.05V6.49h-2.42v1zm-2.93 8.03c-1.76 0-3.1-1.5-3.1-3.52 0-2.05 1.34-3.52 3.1-3.52 1.74 0 3.1 1.5 3.1 3.54.01 2.03-1.36 3.5-3.1 3.5z"/><path fill="#4285F4" d="M38 6.19c-3.21 0-5.83 2.44-5.83 5.81 0 3.34 2.62 5.81 5.83 5.81s5.83-2.46 5.83-5.81c0-3.37-2.62-5.81-5.83-5.81zm0 9.33c-1.76 0-3.28-1.45-3.28-3.52 0-2.09 1.52-3.52 3.28-3.52s3.28 1.43 3.28 3.52c0 2.07-1.52 3.52-3.28 3.52z"/><path fill="#34A853" d="M58 .24h2.51v17.57H58z"/><path fill="#EA4335" d="M68.26 15.52c-1.3 0-2.22-.59-2.82-1.76l7.77-3.21-.26-.66c-.48-1.3-1.96-3.7-4.97-3.7-2.99 0-5.48 2.35-5.48 5.81 0 3.26 2.46 5.81 5.76 5.81 2.66 0 4.2-1.63 4.84-2.57l-1.98-1.32c-.66.96-1.56 1.6-2.86 1.6zm-.18-7.15c1.03 0 1.91.53 2.2 1.28l-5.25 2.17c0-2.44 1.73-3.45 3.05-3.45z"/></svg>
            </span>
          {% endif %}
        </a>
      </div>
    {% endif %}
  </div>
</div>

<script>
(function() {
  var sectionId = '{{ section.id }}';
  var track = document.getElementById('slider-track-' + sectionId);
  var templates = document.getElementById('card-templates-' + sectionId);
  var prevBtn = document.getElementById('prev-' + sectionId);
  var nextBtn = document.getElementById('next-' + sectionId);
  var section = document.getElementById('testimonials-slider2-' + sectionId);

  if (!track || !templates) return;

  var cardTemplates = templates.querySelectorAll('.card-template');
  var totalCards = cardTemplates.length;

  if (totalCards === 0) return;

  var currentIndex = 0;
  var isAnimating = false;
  var animationDuration = 500;
  var autoplay = {{ section.settings.slider_autoplay | json }};
  var autoplaySpeed = {{ section.settings.autoplay_speed | default: 5 }} * 1000;
  var autoplayInterval;

  function cloneCard(index) {
    var template = cardTemplates[index];
    var card = template.cloneNode(true);
    card.className = 'testimonial-card';
    card.setAttribute('data-original-index', index);
    return card;
  }

  function getCardIndex(offset) {
    return ((currentIndex + offset) % totalCards + totalCards) % totalCards;
  }

  function initialRender() {
    track.innerHTML = '';

    for (var pos = 0; pos <= 4; pos++) {
      var offset = pos - 2;
      var idx = getCardIndex(offset);
      var card = cloneCard(idx);
      card.setAttribute('data-position', pos);
      track.appendChild(card);
    }
  }

  function navigate(direction) {
    if (isAnimating) return;
    isAnimating = true;

    var cards = Array.from(track.querySelectorAll('.testimonial-card'));

    if (direction === 'next') {
      currentIndex = (currentIndex + 1) % totalCards;

      cards.forEach(function(card) {
        var currentPos = parseInt(card.getAttribute('data-position'));
        var newPos = currentPos - 1;
        card.setAttribute('data-position', newPos);
      });

      var newIdx = getCardIndex(2);
      var newCard = cloneCard(newIdx);
      newCard.setAttribute('data-position', 5);
      track.appendChild(newCard);

      newCard.offsetHeight;
      newCard.setAttribute('data-position', 4);

      setTimeout(function() {
        var exitedCard = track.querySelector('.testimonial-card[data-position="-1"]');
        if (exitedCard) exitedCard.remove();
        isAnimating = false;
      }, animationDuration);

    } else {
      currentIndex = (currentIndex - 1 + totalCards) % totalCards;

      cards.forEach(function(card) {
        var currentPos = parseInt(card.getAttribute('data-position'));
        var newPos = currentPos + 1;
        card.setAttribute('data-position', newPos);
      });

      var newIdx = getCardIndex(-2);
      var newCard = cloneCard(newIdx);
      newCard.setAttribute('data-position', -1);
      track.insertBefore(newCard, track.firstChild);

      newCard.offsetHeight;
      newCard.setAttribute('data-position', 0);

      setTimeout(function() {
        var exitedCard = track.querySelector('.testimonial-card[data-position="5"]');
        if (exitedCard) exitedCard.remove();
        isAnimating = false;
      }, animationDuration);
    }
  }

  function startAutoplay() {
    if (autoplay) {
      autoplayInterval = setInterval(function() {
        navigate('next');
      }, autoplaySpeed);
    }
  }

  function stopAutoplay() {
    if (autoplayInterval) {
      clearInterval(autoplayInterval);
    }
  }

  nextBtn.addEventListener('click', function() {
    stopAutoplay();
    navigate('next');
    startAutoplay();
  });

  prevBtn.addEventListener('click', function() {
    stopAutoplay();
    navigate('prev');
    startAutoplay();
  });


  var touchStartX = 0;
  var touchEndX = 0;

  track.addEventListener('touchstart', function(e) {
    touchStartX = e.changedTouches[0].screenX;
  }, { passive: true });

  track.addEventListener('touchend', function(e) {
    touchEndX = e.changedTouches[0].screenX;
    var diff = touchStartX - touchEndX;
    if (Math.abs(diff) > 50) {
      stopAutoplay();
      if (diff > 0) navigate('next');
      else navigate('prev');
      startAutoplay();
    }
  }, { passive: true });

  initialRender();
  startAutoplay();
})();
</script>

{% schema %}
{
  "name": "Testimonials Slider 2",
  "tag": "section",
  "class": "section-testimonials-slider2",
  "settings": [
    {
      "type": "header",
      "content": "Style"
    },
    {
      "type": "select",
      "id": "style",
      "label": "Select style",
      "options": [
        { "value": "standard", "label": "Standard" },
        { "value": "trustpilot", "label": "Trustpilot" },
        { "value": "google", "label": "Google" },
        { "value": "custom", "label": "Custom" }
      ],
      "default": "standard"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "info": "Start color for background gradient",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "gradient_start_color",
      "label": "Gradient Start Color (only for custom style)",
      "info": "This setting will only be applied if you selected 'Custom' style.",
      "default": "#EFEFEF"
    },
    {
      "type": "image_picker",
      "id": "own_logo",
      "label": "Optional: Own Logo",
      "info": "Upload your own logo here if you use other review providers"
    },
    {
      "type": "checkbox",
      "id": "slider_autoplay",
      "label": "Slider Autoplay",
      "default": true
    },
    {
      "type": "range",
      "id": "autoplay_speed",
      "min": 2,
      "max": 10,
      "step": 1,
      "unit": "s",
      "label": "Autoplay Speed",
      "info": "Time between slide transitions (in seconds)",
      "default": 5
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "top_margin",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Top Margin",
      "default": 0
    },
    {
      "type": "range",
      "id": "bottom_margin",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Bottom Margin",
      "default": 0
    },
    {
      "type": "range",
      "id": "inside_section_spacing",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Inside Section Spacing Top and Bottom",
      "info": "Inside the section",
      "default": 60
    },
    {
      "type": "header",
      "content": "Color Settings"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "subtitle_color",
      "label": "Subtitle Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "box_background",
      "label": "Box Background",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "box_text",
      "label": "Box Text",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "stars_header",
      "label": "Stars Header",
      "default": "#FFD663"
    },
    {
      "type": "color",
      "id": "stars_box",
      "label": "Stars Box",
      "default": "#FFD663"
    },
    {
      "type": "color",
      "id": "review_text_color",
      "label": "Review Text Color",
      "info": "Color for the review text",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Texts"
    },
    {
      "type": "text",
      "id": "header",
      "label": "Header",
      "default": "Your Satisfaction. Our Mission."
    },
    {
      "type": "text",
      "id": "sub_header",
      "label": "Sub Header",
      "default": "See what other customers say"
    },
    {
      "type": "text",
      "id": "rating_text",
      "label": "Rating Text",
      "default": "Very Good 4.7/5"
    },
    {
      "type": "range",
      "id": "number_of_ratings",
      "min": 1,
      "max": 5,
      "step": 1,
      "label": "Number of Ratings",
      "default": 5
    },
    {
      "type": "header",
      "content": "Button Settings"
    },
    {
      "type": "checkbox",
      "id": "show_button",
      "label": "Show Button",
      "info": "Toggle to show or hide the button",
      "default": true
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "based on 778 ratings"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button Link",
      "info": "Paste a link or search"
    },
    {
      "type": "color",
      "id": "button_background",
      "label": "Button Background Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button Text Color",
      "default": "#FFFFFF"
    },
    {
      "type": "text",
      "id": "verified_text",
      "label": "Verified Text",
      "info": "Text shown for verified ratings",
      "default": "Verified Rating"
    },
    {
      "type": "header",
      "content": "Font Settings"
    },
    {
      "type": "select",
      "id": "header_font",
      "label": "Header Font",
      "options": [
        { "value": "Poppins, sans-serif", "label": "Poppins" },
        { "value": "'Poppins', sans-serif; font-weight: 700", "label": "Poppins Bold" },
        { "value": "Arial, sans-serif", "label": "Arial" },
        { "value": "Helvetica, sans-serif", "label": "Helvetica" },
        { "value": "Georgia, serif", "label": "Georgia" },
        { "value": "inherit", "label": "Theme Default" }
      ],
      "default": "'Poppins', sans-serif; font-weight: 700"
    },
    {
      "type": "select",
      "id": "subtitle_font",
      "label": "Subtitle Font",
      "options": [
        { "value": "Poppins, sans-serif", "label": "Poppins" },
        { "value": "Arial, sans-serif", "label": "Arial" },
        { "value": "Helvetica, sans-serif", "label": "Helvetica" },
        { "value": "Georgia, serif", "label": "Georgia" },
        { "value": "inherit", "label": "Theme Default" }
      ],
      "default": "Poppins, sans-serif"
    },
    {
      "type": "select",
      "id": "rating_font",
      "label": "Rating Font",
      "options": [
        { "value": "Poppins, sans-serif", "label": "Poppins" },
        { "value": "Arial, sans-serif", "label": "Arial" },
        { "value": "Helvetica, sans-serif", "label": "Helvetica" },
        { "value": "Georgia, serif", "label": "Georgia" },
        { "value": "inherit", "label": "Theme Default" }
      ],
      "default": "Poppins, sans-serif"
    },
    {
      "type": "header",
      "content": "Avatar Settings"
    },
    {
      "type": "checkbox",
      "id": "show_avatar",
      "label": "Show Avatar Images",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {
          "type": "textarea",
          "id": "review_text",
          "label": "Review Text",
          "default": "Sternify is fantastic. It has extremely improved my conversion rate and brought my product page to a level with industry experts, all without developers! Everything in the Shopify Theme Builder."
        },
        {
          "type": "text",
          "id": "name",
          "label": "Reviewer Name",
          "default": "Max M."
        },
        {
          "type": "text",
          "id": "date",
          "label": "Date",
          "default": "2 days ago"
        },
        {
          "type": "image_picker",
          "id": "avatar",
          "label": "Avatar Image"
        },
        {
          "type": "range",
          "id": "stars",
          "min": 1,
          "max": 5,
          "step": 1,
          "label": "Star Rating",
          "default": 5
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Testimonials Slider 2",
      "blocks": [
        {
          "type": "testimonial",
          "settings": {
            "review_text": "Sternify is fantastic. It has extremely improved my conversion rate and brought my product page to a level with industry experts, all without developers! Everything in the Shopify Theme Builder.",
            "name": "Max M.",
            "date": "2 days ago",
            "stars": 5
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "review_text": "Sternify is fantastic. It has extremely improved my conversion rate and brought my product page to a level with industry experts, all without developers! Everything in the Shopify Theme Builder.",
            "name": "Max M.",
            "date": "3 days ago",
            "stars": 5
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "review_text": "Sternify is fantastic. It has extremely improved my conversion rate and brought my product page to a level with industry experts, all without developers! Everything in the Shopify Theme Builder.",
            "name": "Max M.",
            "date": "5 days ago",
            "stars": 5
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "review_text": "Sternify is fantastic. It has extremely improved my conversion rate and brought my product page to a level with industry experts, all without developers! Everything in the Shopify Theme Builder.",
            "name": "Max M.",
            "date": "1 week ago",
            "stars": 5
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "review_text": "Sternify is fantastic. It has extremely improved my conversion rate and brought my product page to a level with industry experts, all without developers! Everything in the Shopify Theme Builder.",
            "name": "Max M.",
            "date": "2 weeks ago",
            "stars": 5
          }
        }
      ]
    }
  ]
}
{% endschema %}
