{% comment %}
  Section: You May Also Like
  Product recommendations grid with collection selection
{% endcomment %}

<section class="you-may-like">
  <div class="you-may-like__container">

    {%- if section.settings.heading != blank -%}
      <h2 class="you-may-like__heading">{{ section.settings.heading }}</h2>
    {%- endif -%}

    {%- assign collection = collections[section.settings.collection] -%}
    {%- assign products_to_show = section.settings.products_count | default: 5 -%}

    <div class="you-may-like__grid {% if section.settings.enable_mobile_slider %}you-may-like__grid--slider{% endif %}">

      {%- if collection != blank and collection.products.size > 0 -%}
        {%- for product in collection.products limit: products_to_show -%}
          <div class="you-may-like__card">
            <a href="{{ product.url }}" class="you-may-like__card-link">

              <div class="you-may-like__image-wrapper">
                {%- if product.featured_image -%}
                  <img
                    src="{{ product.featured_image | image_url: width: 400 }}"
                    srcset="{{ product.featured_image | image_url: width: 200 }} 200w,
                            {{ product.featured_image | image_url: width: 300 }} 300w,
                            {{ product.featured_image | image_url: width: 400 }} 400w"
                    sizes="(min-width: 990px) 20vw, (min-width: 750px) 33vw, 100vw"
                    alt="{{ product.featured_image.alt | escape }}"
                    class="you-may-like__image"
                    loading="lazy"
                  >
                {%- else -%}
                  <div class="you-may-like__placeholder">
                    {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
                  </div>
                {%- endif -%}
              </div>

              <div class="you-may-like__info">
                <h3 class="you-may-like__title">{{ product.title }}</h3>

                <div class="you-may-like__price">
                  {%- if product.compare_at_price > product.price -%}
                    <span class="you-may-like__compare-price">{{ product.compare_at_price | money }}</span>
                  {%- endif -%}
                  <span class="you-may-like__sale-price">{{ product.price | money }}</span>
                </div>

                {%- if section.settings.show_ratings -%}
                  <div class="you-may-like__rating">
                    <div class="you-may-like__stars">
                      {%- for i in (1..5) -%}
                        <svg class="you-may-like__star" viewBox="0 0 24 24" fill="currentColor">
                          <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                        </svg>
                      {%- endfor -%}
                    </div>
                    <span class="you-may-like__reviews">({{ section.settings.review_count | default: 22 }})</span>
                  </div>
                {%- endif -%}

              </div>
            </a>
          </div>
        {%- endfor -%}

      {%- else -%}
        {%- comment -%} Fallback placeholder products {%- endcomment -%}
        {%- for i in (1..products_to_show) -%}
          <div class="you-may-like__card">
            <div class="you-may-like__card-link">
              <div class="you-may-like__image-wrapper">
                <div class="you-may-like__placeholder">
                  {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
                </div>
              </div>
              <div class="you-may-like__info">
                <h3 class="you-may-like__title">Product Title {{ i }}</h3>
                <div class="you-may-like__price">
                  <span class="you-may-like__compare-price">$225.10</span>
                  <span class="you-may-like__sale-price">$107.10</span>
                </div>
                {%- if section.settings.show_ratings -%}
                  <div class="you-may-like__rating">
                    <div class="you-may-like__stars">
                      {%- for j in (1..5) -%}
                        <svg class="you-may-like__star" viewBox="0 0 24 24" fill="currentColor">
                          <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                        </svg>
                      {%- endfor -%}
                    </div>
                    <span class="you-may-like__reviews">(22)</span>
                  </div>
                {%- endif -%}
              </div>
            </div>
          </div>
        {%- endfor -%}
      {%- endif -%}

    </div>

  </div>
</section>

<style>
  .you-may-like {
    padding: {{ section.settings.padding_top }}px 0 {{ section.settings.padding_bottom }}px;
    background-color: {{ section.settings.background_color }};
    margin-bottom: 120px;
  }

  .you-may-like__container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 20px;
  }

  .you-may-like__heading {
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: {{ section.settings.heading_color }};
    margin: 0 0 32px 0;
  }

  .you-may-like__grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 20px;
  }

  .you-may-like__card {
    position: relative;
    display: flex;
    flex-direction: column;
  }

  .you-may-like__card-link {
    text-decoration: none;
    color: inherit;
    display: flex;
    flex-direction: column;
    height: 100%;
    transition: opacity 0.3s ease;
  }

  .you-may-like__card-link:hover {
    opacity: 0.8;
  }

  .you-may-like__image-wrapper {
    position: relative;
    width: 100%;
    padding-bottom: 100%;
    overflow: hidden;
    background-color: #f5f5f5;
    margin-bottom: 12px;
  }

  .you-may-like__image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .you-may-like__placeholder {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #e0e0e0;
  }

  .placeholder-svg {
    width: 50%;
    height: 50%;
    opacity: 0.3;
  }

  .you-may-like__info {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .you-may-like__title {
    font-size: 13px;
    font-weight: 400;
    line-height: 1.3;
    color: {{ section.settings.text_color }};
    margin: 0;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  .you-may-like__price {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
  }

  .you-may-like__compare-price {
    font-size: 12px;
    color: #999;
    text-decoration: line-through;
  }

  .you-may-like__sale-price {
    font-size: 14px;
    font-weight: 700;
    color: {{ section.settings.price_color }};
  }

  .you-may-like__rating {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .you-may-like__stars {
    display: flex;
    gap: 2px;
  }

  .you-may-like__star {
    width: 14px;
    height: 14px;
    color: {{ section.settings.star_color }};
  }

  .you-may-like__reviews {
    font-size: 11px;
    color: #666;
  }

  /* Tablet */
  @media screen and (max-width: 989px) {
    .you-may-like__grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
    }

    .you-may-like__heading {
      font-size: 13px;
      margin-bottom: 24px;
    }
  }

  /* Mobile */
  @media screen and (max-width: 749px) {
    .you-may-like {
      padding: {{ section.settings.padding_top | divided_by: 2 }}px 0 {{ section.settings.padding_bottom | divided_by: 2 }}px;
    }

    .you-may-like__container {
      padding: 0 16px;
    }

    .you-may-like__heading {
      font-size: 12px;
      margin-bottom: 20px;
    }

    .you-may-like__grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .you-may-like__grid--slider {
      display: flex;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      gap: 12px;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .you-may-like__grid--slider::-webkit-scrollbar {
      display: none;
    }

    .you-may-like__grid--slider .you-may-like__card {
      flex: 0 0 70%;
      scroll-snap-align: start;
    }

    .you-may-like__title {
      font-size: 12px;
    }

    .you-may-like__compare-price {
      font-size: 11px;
    }

    .you-may-like__sale-price {
      font-size: 13px;
    }

    .you-may-like__star {
      width: 12px;
      height: 12px;
    }

    .you-may-like__reviews {
      font-size: 10px;
    }
  }
</style>

{% schema %}
{
  "name": "You May Also Like",
  "class": "section-you-may-like",
  "settings": [
    {
      "type": "header",
      "content": "Section Settings"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "YOU MAY ALSO LIKE"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_count",
      "min": 3,
      "max": 10,
      "step": 1,
      "label": "Number of Products",
      "default": 5
    },
    {
      "type": "checkbox",
      "id": "show_ratings",
      "label": "Show Star Ratings",
      "default": true
    },
    {
      "type": "range",
      "id": "review_count",
      "min": 0,
      "max": 100,
      "step": 1,
      "label": "Default Review Count",
      "default": 22,
      "info": "Used when actual reviews are not available"
    },
    {
      "type": "checkbox",
      "id": "enable_mobile_slider",
      "label": "Enable Horizontal Scroll on Mobile",
      "default": true
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Product Title Color",
      "default": "#333333"
    },
    {
      "type": "color",
      "id": "price_color",
      "label": "Sale Price Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "star_color",
      "label": "Star Rating Color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Section Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Padding Top",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 60
    }
  ],
  "presets": [
    {
      "name": "You May Also Like"
    }
  ]
}
{% endschema %}
