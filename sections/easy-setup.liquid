{% comment %}
  SEK Easy Setup Steps - Step-by-step guide with numbered cards
  Features: Image cards with step numbers, CTA button, mobile slider
{% endcomment %}

{%- assign section_id = section.id -%}

{% style %}
  #sek-easy-setup-{{ section_id }} {
    padding: {{ section.settings.padding_top_mobile }}px 0 {{ section.settings.padding_bottom_mobile }}px;
    background: {{ section.settings.background_color }};
  }

  @media (min-width: 750px) {
    #sek-easy-setup-{{ section_id }} {
      padding: {{ section.settings.padding_top }}px 0 {{ section.settings.padding_bottom }}px;
    }
  }

  #sek-easy-setup-{{ section_id }} .sek-es__container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
  }

  @media (min-width: 750px) {
    #sek-easy-setup-{{ section_id }} .sek-es__container {
      padding: 0 40px;
    }
  }

  /* Header */
  #sek-easy-setup-{{ section_id }} .sek-es__header {
    text-align: center;
    margin-bottom: 30px;
  }

  @media (min-width: 750px) {
    #sek-easy-setup-{{ section_id }} .sek-es__header {
      margin-bottom: 40px;
    }
  }

  #sek-easy-setup-{{ section_id }} .sek-es__heading {
    font-size: 28px;
    font-weight: 800;
    line-height: 1.2;
    color: {{ section.settings.heading_color }};
    margin: 0;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  @media (min-width: 750px) {
    #sek-easy-setup-{{ section_id }} .sek-es__heading {
      font-size: 36px;
    }
  }

  @media (min-width: 990px) {
    #sek-easy-setup-{{ section_id }} .sek-es__heading {
      font-size: 42px;
    }
  }

  /* Steps Grid */
  #sek-easy-setup-{{ section_id }} .sek-es__grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 20px;
    margin-bottom: 30px;
  }

  @media (min-width: 750px) {
    #sek-easy-setup-{{ section_id }} .sek-es__grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 24px;
      margin-bottom: 40px;
    }
  }

  /* Mobile Slider */
  #sek-easy-setup-{{ section_id }} .sek-es__slider {
    display: block;
    margin-bottom: 30px;
  }

  @media (min-width: 750px) {
    #sek-easy-setup-{{ section_id }} .sek-es__slider {
      display: none;
    }
  }

  #sek-easy-setup-{{ section_id }} .sek-es__slider .swiper {
    overflow: visible;
    padding: 0 20px;
    margin: 0 -20px;
  }

  #sek-easy-setup-{{ section_id }} .sek-es__grid--desktop {
    display: none;
  }

  @media (min-width: 750px) {
    #sek-easy-setup-{{ section_id }} .sek-es__grid--desktop {
      display: grid;
    }
  }

  /* Step Card */
  #sek-easy-setup-{{ section_id }} .sek-es__card {
    background: {{ section.settings.card_background }};
    border-radius: {{ section.settings.card_border_radius }}px;
    padding: 20px;
    text-align: center;
  }

  @media (min-width: 750px) {
    #sek-easy-setup-{{ section_id }} .sek-es__card {
      padding: 23px 27px;
    }
  }

  #sek-easy-setup-{{ section_id }} .sek-es__card-image {
    width: 100%;
    aspect-ratio: 1 / 1;
    border-radius: {{ section.settings.image_border_radius }}px;
    overflow: hidden;
    margin-bottom: 20px;
  }

  #sek-easy-setup-{{ section_id }} .sek-es__card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  #sek-easy-setup-{{ section_id }} .sek-es__card-image--placeholder {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #e0e0e0 0%, #c0c0c0 100%);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #sek-easy-setup-{{ section_id }} .sek-es__card-image--placeholder svg {
    width: 60px;
    height: 60px;
    opacity: 0.4;
  }

  /* Step Number Badge */
  #sek-easy-setup-{{ section_id }} .sek-es__step-number {
    width: 44px;
    height: 44px;
    border: 1px solid {{ section.settings.step_number_border_color }};
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 16px;
    background: {{ section.settings.step_number_background }};
  }

  @media (min-width: 750px) {
    #sek-easy-setup-{{ section_id }} .sek-es__step-number {
      width: 50px;
      height: 50px;
    }
  }

  #sek-easy-setup-{{ section_id }} .sek-es__step-number span {
    font-size: 16px;
    font-weight: 500;
    color: {{ section.settings.step_number_color }};
    line-height: 1;
  }

  @media (min-width: 750px) {
    #sek-easy-setup-{{ section_id }} .sek-es__step-number span {
      font-size: 18px;
    }
  }

  /* Step Text */
  #sek-easy-setup-{{ section_id }} .sek-es__step-text {
    font-size: 15px;
    font-weight: 600;
    line-height: 1.4;
    color: {{ section.settings.text_color }};
    margin: 0;
  }

  @media (min-width: 750px) {
    #sek-easy-setup-{{ section_id }} .sek-es__step-text {
      font-size: 16px;
    }
  }

  /* CTA Button */
  #sek-easy-setup-{{ section_id }} .sek-es__cta {
    text-align: center;
  }

  #sek-easy-setup-{{ section_id }} .sek-es__button {
    display: inline-block;
    padding: 14px 40px;
    font-size: 13px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: {{ section.settings.button_text_color }};
    background: {{ section.settings.button_background }};
    border: 1px solid {{ section.settings.button_border_color }};
    border-radius: 45px;
    text-decoration: none;
    transition: all 0.3s ease;
    cursor: pointer;
  }

  @media (min-width: 750px) {
    #sek-easy-setup-{{ section_id }} .sek-es__button {
      padding: 16px 50px;
      font-size: 14px;
    }
  }

  #sek-easy-setup-{{ section_id }} .sek-es__button:hover {
    background: {{ section.settings.button_hover_background }};
    color: {{ section.settings.button_hover_text_color }};
    border-color: {{ section.settings.button_hover_background }};
  }
{% endstyle %}

<section id="sek-easy-setup-{{ section_id }}" class="sek-easy-setup">
  <div class="sek-es__container">
    <!-- Header -->
    {%- if section.settings.heading != blank -%}
      <div class="sek-es__header">
        <h2 class="sek-es__heading">{{ section.settings.heading }}</h2>
      </div>
    {%- endif -%}

    <!-- Mobile Slider -->
    <div class="sek-es__slider">
      <div class="swiper sek-es__swiper">
        <div class="swiper-wrapper">
          {%- assign step_count = 0 -%}
          {%- for block in section.blocks -%}
            {%- if block.type == 'step' -%}
              {%- assign step_count = step_count | plus: 1 -%}
              <div class="swiper-slide">
                <div class="sek-es__card" {{ block.shopify_attributes }}>
                  <div class="sek-es__card-image">
                    {%- if block.settings.image != blank -%}
                      <img
                        src="{{ block.settings.image | image_url: width: 600 }}"
                        alt="{{ block.settings.step_text | escape }}"
                        loading="lazy"
                        width="600"
                        height="600"
                      >
                    {%- else -%}
                      <div class="sek-es__card-image--placeholder">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                          <circle cx="8.5" cy="8.5" r="1.5"></circle>
                          <polyline points="21 15 16 10 5 21"></polyline>
                        </svg>
                      </div>
                    {%- endif -%}
                  </div>
                  <div class="sek-es__step-number">
                    <span>{{ step_count }}</span>
                  </div>
                  {%- if block.settings.step_text != blank -%}
                    <p class="sek-es__step-text">{{ block.settings.step_text }}</p>
                  {%- endif -%}
                </div>
              </div>
            {%- endif -%}
          {%- endfor -%}

          {%- if section.blocks.size == 0 -%}
            {%- for i in (1..3) -%}
              <div class="swiper-slide">
                <div class="sek-es__card">
                  <div class="sek-es__card-image">
                    <div class="sek-es__card-image--placeholder">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                        <polyline points="21 15 16 10 5 21"></polyline>
                      </svg>
                    </div>
                  </div>
                  <div class="sek-es__step-number">
                    <span>{{ i }}</span>
                  </div>
                  <p class="sek-es__step-text">
                    {%- case i -%}
                      {%- when 1 -%}Rip open the package
                      {%- when 2 -%}Put in a cup with tea & stir
                      {%- when 3 -%}Enjoy the funky stuff
                    {%- endcase -%}
                  </p>
                </div>
              </div>
            {%- endfor -%}
          {%- endif -%}
        </div>
      </div>
    </div>

    <!-- Desktop Grid -->
    <div class="sek-es__grid sek-es__grid--desktop">
      {%- assign step_count = 0 -%}
      {%- for block in section.blocks -%}
        {%- if block.type == 'step' -%}
          {%- assign step_count = step_count | plus: 1 -%}
          <div class="sek-es__card" {{ block.shopify_attributes }}>
            <div class="sek-es__card-image">
              {%- if block.settings.image != blank -%}
                <img
                  src="{{ block.settings.image | image_url: width: 600 }}"
                  alt="{{ block.settings.step_text | escape }}"
                  loading="lazy"
                  width="600"
                  height="600"
                >
              {%- else -%}
                <div class="sek-es__card-image--placeholder">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21 15 16 10 5 21"></polyline>
                  </svg>
                </div>
              {%- endif -%}
            </div>
            <div class="sek-es__step-number">
              <span>{{ step_count }}</span>
            </div>
            {%- if block.settings.step_text != blank -%}
              <p class="sek-es__step-text">{{ block.settings.step_text }}</p>
            {%- endif -%}
          </div>
        {%- endif -%}
      {%- endfor -%}

      {%- if section.blocks.size == 0 -%}
        {%- for i in (1..3) -%}
          <div class="sek-es__card">
            <div class="sek-es__card-image">
              <div class="sek-es__card-image--placeholder">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                  <circle cx="8.5" cy="8.5" r="1.5"></circle>
                  <polyline points="21 15 16 10 5 21"></polyline>
                </svg>
              </div>
            </div>
            <div class="sek-es__step-number">
              <span>{{ i }}</span>
            </div>
            <p class="sek-es__step-text">
              {%- case i -%}
                {%- when 1 -%}Rip open the package
                {%- when 2 -%}Put in a cup with tea & stir
                {%- when 3 -%}Enjoy the funky stuff
              {%- endcase -%}
            </p>
          </div>
        {%- endfor -%}
      {%- endif -%}
    </div>

    <!-- CTA Button -->
    {%- if section.settings.button_text != blank -%}
      <div class="sek-es__cta">
        <a href="{{ section.settings.button_url }}" class="sek-es__button">
          {{ section.settings.button_text }}
        </a>
      </div>
    {%- endif -%}
  </div>
</section>

<script>
  (function() {
    function initEasySetup() {
      const sectionId = '{{ section_id }}';
      const section = document.getElementById('sek-easy-setup-' + sectionId);
      if (!section) return;

      const swiperEl = section.querySelector('.sek-es__swiper');
      if (!swiperEl) return;

      // Only initialize on mobile
      if (window.innerWidth < 750) {
        if (typeof Swiper !== 'undefined') {
          new Swiper(swiperEl, {
            slidesPerView: 1.2,
            spaceBetween: 16,
            centeredSlides: false
          });
        }
      }
    }

    // Load Swiper if not already loaded
    if (typeof Swiper === 'undefined') {
      const link = document.createElement('link');
      link.rel = 'stylesheet';
      link.href = 'https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css';
      document.head.appendChild(link);

      const script = document.createElement('script');
      script.src = 'https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js';
      script.onload = initEasySetup;
      document.head.appendChild(script);
    } else {
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initEasySetup);
      } else {
        initEasySetup();
      }
    }
  })();
</script>

{% schema %}
{
  "name": "SEK Easy Setup Steps",
  "tag": "section",
  "class": "sek-easy-setup-section",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Easy Set Up in 3 Steps"
    },
    {
      "type": "header",
      "content": "Button"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Shop Now"
    },
    {
      "type": "url",
      "id": "button_url",
      "label": "Button URL"
    },
    {
      "type": "header",
      "content": "Card Style"
    },
    {
      "type": "range",
      "id": "card_border_radius",
      "label": "Card border radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "default": 28,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "image_border_radius",
      "label": "Image border radius",
      "min": 0,
      "max": 30,
      "step": 2,
      "default": 20,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Section Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding top (desktop)",
      "min": 0,
      "max": 120,
      "step": 5,
      "default": 60,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding bottom (desktop)",
      "min": 0,
      "max": 120,
      "step": 5,
      "default": 60,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "label": "Padding top (mobile)",
      "min": 0,
      "max": 80,
      "step": 5,
      "default": 40,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "label": "Padding bottom (mobile)",
      "min": 0,
      "max": 80,
      "step": 5,
      "default": 40,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#c9a9d4"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#3d2a47"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#3d2a47"
    },
    {
      "type": "color",
      "id": "card_background",
      "label": "Card background",
      "default": "#fef9f3"
    },
    {
      "type": "header",
      "content": "Step Number Colors"
    },
    {
      "type": "color",
      "id": "step_number_background",
      "label": "Step number background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "step_number_color",
      "label": "Step number color",
      "default": "#3d2a47"
    },
    {
      "type": "color",
      "id": "step_number_border_color",
      "label": "Step number border color",
      "default": "#3d2a47"
    },
    {
      "type": "header",
      "content": "Button Colors"
    },
    {
      "type": "color",
      "id": "button_background",
      "label": "Button background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text color",
      "default": "#3d2a47"
    },
    {
      "type": "color",
      "id": "button_border_color",
      "label": "Button border color",
      "default": "#3d2a47"
    },
    {
      "type": "color",
      "id": "button_hover_background",
      "label": "Button hover background",
      "default": "#3d2a47"
    },
    {
      "type": "color",
      "id": "button_hover_text_color",
      "label": "Button hover text color",
      "default": "#ffffff"
    }
  ],
  "blocks": [
    {
      "type": "step",
      "name": "Step",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "step_text",
          "label": "Step description",
          "default": "Step description here"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "SEK Easy Setup Steps",
      "blocks": [
        {
          "type": "step",
          "settings": {
            "step_text": "Rip open the package"
          }
        },
        {
          "type": "step",
          "settings": {
            "step_text": "Put in a cup with tea & stir"
          }
        },
        {
          "type": "step",
          "settings": {
            "step_text": "Enjoy the funky stuff"
          }
        }
      ]
    }
  ]
}
{% endschema %}
